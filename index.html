<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ticket to Ride Score Calculator</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            width: 100%;
            font-family: Arial, sans-serif;
        }

        .tabs {
            font-size: 0;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            box-sizing: border-box;
        }

        .tabs>input[type="radio"] {
            display: none;
        }

        .tabs>div {
            display: none;
            border: 1px solid #e0e0e0;
            padding: 10px 15px;
            font-size: 16px;
            box-sizing: border-box;
        }

        .list, .ttr, .dest, .ScoreCars {
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }

        #tab-btn-1:checked~#content-1,
        #tab-btn-2:checked~#content-2,
        #tab-btn-3:checked~#content-3,
        #tab-btn-4:checked~#content-4 {
            display: block;
        }

        .tabs>label {
            display: inline-block;
            text-align: center;
            vertical-align: middle;
            user-select: none;
            background-color: #f5f5f5;
            border: 1px solid #e0e0e0;
            padding: 10px;
            font-size: 16px;
            line-height: 1.5;
            transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out;
            cursor: pointer;
            position: relative;
            top: 1px;
        }

        .tabs>label:not(:first-of-type) {
            border-left: none;
        }

        .tabs>input[type="radio"]:checked+label {
            background-color: #fff;
            border-bottom: 1px solid #fff;
        }

        .popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px;
            background: white;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-shadow: 0px 0px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            text-align: center;
        }

        .popup button {
            width: 40px;
            height: 40px;
            margin: 5px;
            font-size: 16px;
        }

        .quantity-input {
            min-width: 40px;
            padding: 5px;
        }

        .station-input {
            min-width: 40px; /* Уменьшено с 80px до 40px */
            padding: 5px;
        }

        .pnts-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .pnts-item {
            flex: 1 0 30%;
            display: flex;
            align-items: center;
            box-sizing: border-box;
            flex-wrap: nowrap; /* Запрещаем перенос элементов внутри .pnts-item */
        }

        .pnts-item label {
            margin-right: 5px;
            white-space: nowrap; /* Запрещаем перенос текста в label */
            font-size: 14px; /* Уменьшаем размер шрифта для метки */
        }

        .pnts-item input {
            width: 100%;
            min-width: 20px; /* Уменьшаем минимальную ширину поля ввода */
            padding: 5px;
            box-sizing: border-box;
        }

        @media (max-width: 576px) {
            .tabs>label {
                padding: 5px;
                font-size: 14px;
            }

            .tabs>div {
                padding: 5px;
                font-size: 14px;
            }

            .popup {
                padding: 10px;
            }

            .popup button {
                width: 35px;
                height: 35px;
                font-size: 14px;
            }

            .quantity-input {
                min-width: 35px;
            }

            .station-input {
                min-width: 35px; /* Уменьшено с 70px до 35px */
            }

            .pnts-item {
                flex: 1 0 30%; /* Сохраняем 3 столбца */
            }

            .pnts-item label {
                font-size: 12px; /* Еще уменьшаем шрифт на мобильных */
            }

            .pnts-item input {
                min-width: 15px; /* Еще уменьшаем поле ввода на мобильных */
            }
        }
    </style>
</head>
<body>
    <div class="tabs">
        <input type="radio" name="tab-btn" id="tab-btn-1" value="" checked>
        <label for="tab-btn-1">Red <span id="red-score">(0)</span></label>
        <input type="radio" name="tab-btn" id="tab-btn-2" value="">
        <label for="tab-btn-2">Blue <span id="blue-score">(0)</span></label>
        <input type="radio" name="tab-btn" id="tab-btn-3" value="">
        <label for="tab-btn-3">Green <span id="green-score">(0)</span></label>
        <input type="radio" name="tab-btn" id="tab-btn-4" value="">
        <label for="tab-btn-4">Yellow <span id="yellow-score">(0)</span></label>

        <!-- Вкладка для Red -->
        <div class="list" id="content-1">
            <fieldset class="ttr">
                <legend>TICKET TO RIDE</legend>
                <label for="num11">Train 1 </label><input class="quantity-input" id="num11"/> (x1)<p></p>
                <label for="num21">Train 2 </label><input class="quantity-input" id="num21"/> (x2)<p></p>
                <label for="num31">Train 3 </label><input class="quantity-input" id="num31"/> (x4)<p></p>
                <label for="num41">Train 4 </label><input class="quantity-input" id="num41"/> (x7)<p></p>
                <label for="num61">Train 6 </label><input class="quantity-input" id="num61"/> (x15)<p></p>
                <label for="num81">Train 8 </label><input class="quantity-input" id="num81"/> (x21)<p></p>
                <fieldset class="dest">
                    <legend>Destination Ticket [Bonus/Penalty]</legend>
                    <label for="stan1">Stations </label><input class="station-input" id="stan1"/> on the playing field<p></p>
                    <div class="pnts-grid">
                        <div class="pnts-item"><label for="pereg11">Pnts 1</label><input id="pereg11" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg21">Pnts 2</label><input id="pereg21" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg31">Pnts 3</label><input id="pereg31" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg41">Pnts 4</label><input id="pereg41" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg51">Pnts 5</label><input id="pereg51" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg61">Pnts 6</label><input id="pereg61" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg71">Pnts 7</label><input id="pereg71" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg81">Pnts 8</label><input id="pereg81" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg91">Pnts 9</label><input id="pereg91" class="pnts-input"/></div>
                    </div>
                    <p><input type="checkbox" id="one1"> Express Bonus</p>
                </fieldset>
            </fieldset>
            <p></p>
            <button style="padding: 20px 40px; color: rgb(5, 0, 0); background-color: rgb(248, 68, 36); border-radius: 15px;" onclick="calculateScore(1)"><b>Calculating Scores</b></button>
            <p></p>
            <fieldset class="ScoreCars"><legend>Final Score:</legend><p id="result1">score</p></fieldset>
            <fieldset class="ScoreCars"><legend>Train Cars:</legend><p>45 = <span id="kol1">qty. of train cars on the game board</span> + <span id="kol1_ost">qty. remaining</span></p></fieldset>
        </div>

        <!-- Вкладка для Blue -->
        <div class="list" id="content-2">
            <fieldset class="ttr">
                <legend>TICKET TO RIDE</legend>
                <label for="num12">Train 1 </label><input class="quantity-input" id="num12"/> (x1)<p></p>
                <label for="num22">Train 2 </label><input class="quantity-input" id="num22"/> (x2)<p></p>
                <label for="num32">Train 3 </label><input class="quantity-input" id="num32"/> (x4)<p></p>
                <label for="num42">Train 4 </label><input class="quantity-input" id="num42"/> (x7)<p></p>
                <label for="num62">Train 6 </label><input class="quantity-input" id="num62"/> (x15)<p></p>
                <label for="num82">Train 8 </label><input class="quantity-input" id="num82"/> (x21)<p></p>
                <fieldset class="dest">
                    <legend>Destination Ticket [Bonus/Penalty]</legend>
                    <label for="stan2">Stations </label><input class="station-input" id="stan2"/> on the playing field<p></p>
                    <div class="pnts-grid">
                        <div class="pnts-item"><label for="pereg12">Pnts 1</label><input id="pereg12" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg22">Pnts 2</label><input id="pereg22" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg32">Pnts 3</label><input id="pereg32" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg42">Pnts 4</label><input id="pereg42" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg52">Pnts 5</label><input id="pereg52" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg62">Pnts 6</label><input id="pereg62" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg72">Pnts 7</label><input id="pereg72" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg82">Pnts 8</label><input id="pereg82" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg92">Pnts 9</label><input id="pereg92" class="pnts-input"/></div>
                    </div>
                    <p><input type="checkbox" id="one2"> Express Bonus</p>
                </fieldset>
            </fieldset>
            <p></p>
            <button style="padding: 20px 40px; color: rgb(250, 246, 246); background-color: rgb(36, 50, 248); border-radius: 15px;" onclick="calculateScore(2)"><b>Calculating Scores</b></button>
            <p></p>
            <fieldset class="ScoreCars"><legend>Final Score:</legend><p id="result2">score</p></fieldset>
            <fieldset class="ScoreCars"><legend>Train Cars:</legend><p>45 = <span id="kol2">qty. of train cars on the game board</span> + <span id="kol2_ost">qty. remaining</span></p></fieldset>
        </div>

        <!-- Вкладка для Green -->
        <div class="list" id="content-3">
            <fieldset class="ttr">
                <legend>TICKET TO RIDE</legend>
                <label for="num13">Train 1 </label><input class="quantity-input" id="num13"/> (x1)<p></p>
                <label for="num23">Train 2 </label><input class="quantity-input" id="num23"/> (x2)<p></p>
                <label for="num33">Train 3 </label><input class="quantity-input" id="num33"/> (x4)<p></p>
                <label for="num43">Train 4 </label><input class="quantity-input" id="num43"/> (x7)<p></p>
                <label for="num63">Train 6 </label><input class="quantity-input" id="num63"/> (x15)<p></p>
                <label for="num83">Train 8 </label><input class="quantity-input" id="num83"/> (x21)<p></p>
                <fieldset class="dest">
                    <legend>Destination Ticket [Bonus/Penalty]</legend>
                    <label for="stan3">Stations </label><input class="station-input" id="stan3"/> on the playing field<p></p>
                    <div class="pnts-grid">
                        <div class="pnts-item"><label for="pereg13">Pnts 1</label><input id="pereg13" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg23">Pnts 2</label><input id="pereg23" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg33">Pnts 3</label><input id="pereg33" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg43">Pnts 4</label><input id="pereg43" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg53">Pnts 5</label><input id="pereg53" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg63">Pnts 6</label><input id="pereg63" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg73">Pnts 7</label><input id="pereg73" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg83">Pnts 8</label><input id="pereg83" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg93">Pnts 9</label><input id="pereg93" class="pnts-input"/></div>
                    </div>
                    <p><input type="checkbox" id="one3"> Express Bonus</p>
                </fieldset>
            </fieldset>
            <p></p>
            <button style="padding: 20px 40px; color: rgb(5, 0, 0); background-color: rgb(36, 248, 64); border-radius: 15px;" onclick="calculateScore(3)"><b>Calculating Scores</b></button>
            <p></p>
            <fieldset class="ScoreCars"><legend>Final Score:</legend><p id="result3">score</p></fieldset>
            <fieldset class="ScoreCars"><legend>Train Cars:</legend><p>45 = <span id="kol3">qty. of train cars on the game board</span> + <span id="kol3_ost">qty. remaining</span></p></fieldset>
        </div>

        <!-- Вкладка для Yellow -->
        <div class="list" id="content-4">
            <fieldset class="ttr">
                <legend>TICKET TO RIDE</legend>
                <label for="num14">Train 1 </label><input class="quantity-input" id="num14"/> (x1)<p></p>
                <label for="num24">Train 2 </label><input class="quantity-input" id="num24"/> (x2)<p></p>
                <label for="num34">Train 3 </label><input class="quantity-input" id="num34"/> (x4)<p></p>
                <label for="num44">Train 4 </label><input class="quantity-input" id="num44"/> (x7)<p></p>
                <label for="num64">Train 6 </label><input class="quantity-input" id="num64"/> (x15)<p></p>
                <label for="num84">Train 8 </label><input class="quantity-input" id="num84"/> (x21)<p></p>
                <fieldset class="dest">
                    <legend>Destination Ticket [Bonus/Penalty]</legend>
                    <label for="stan4">Stations </label><input class="station-input" id="stan4"/> on the playing field<p></p>
                    <div class="pnts-grid">
                        <div class="pnts-item"><label for="pereg14">Pnts 1</label><input id="pereg14" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg24">Pnts 2</label><input id="pereg24" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg34">Pnts 3</label><input id="pereg34" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg44">Pnts 4</label><input id="pereg44" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg54">Pnts 5</label><input id="pereg54" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg64">Pnts 6</label><input id="pereg64" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg74">Pnts 7</label><input id="pereg74" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg84">Pnts 8</label><input id="pereg84" class="pnts-input"/></div>
                        <div class="pnts-item"><label for="pereg94">Pnts 9</label><input id="pereg94" class="pnts-input"/></div>
                    </div>
                    <p><input type="checkbox" id="one4"> Express Bonus</p>
                </fieldset>
            </fieldset>
            <p></p>
            <button style="padding: 20px 40px; color: rgb(5, 0, 0); background-color: rgb(234, 248, 36); border-radius: 15px;" onclick="calculateScore(4)"><b>Calculating Scores</b></button>
            <p></p>
            <fieldset class="ScoreCars"><legend>Final Score:</legend><p id="result4">score</p></fieldset>
            <fieldset class="ScoreCars"><legend>Train Cars:</legend><p>45 = <span id="kol4">qty. of train cars on the game board</span> + <span id="kol4_ost">qty. remaining</span></p></fieldset>
        </div>
    </div>

    <!-- Попапы -->
    <div id="train-popup" class="popup">
        <button onclick="setTrainQuantity(0)">0</button>
        <button onclick="setTrainQuantity(1)">1</button>
        <button onclick="setTrainQuantity(2)">2</button>
        <button onclick="setTrainQuantity(3)">3</button>
        <button onclick="setTrainQuantity(4)">4</button>
        <button onclick="setTrainQuantity(5)">5</button>
        <button onclick="setTrainQuantity(6)">6</button>
        <button onclick="setTrainQuantity(7)">7</button>
        <button onclick="setTrainQuantity(8)">8</button>
        <button onclick="setTrainQuantity(9)">9</button>
    </div>

    <div id="station-popup" class="popup">
        <button onclick="setStationQuantity(0)">0</button>
        <button onclick="setStationQuantity(1)">1</button>
        <button onclick="setStationQuantity(2)">2</button>
        <button onclick="setStationQuantity(3)">3</button>
    </div>

    <div id="pnts-popup" class="popup">
        <div>Current: <span id="pnts-current-value">0</span></div>
        <button onclick="changePnts(-10)">-10</button>
        <button onclick="changePnts(-1)">-1</button>
        <button onclick="changePnts(1)">+1</button>
        <button onclick="changePnts(10)">+10</button>
        <button onclick="setPntsValue()">OK</button>
    </div>

    <!-- JavaScript -->
    <script>
        const soundFiles = [
            'https://zvukipro.com/uploads/files/2021-04/1617869497_87223b11f59f15c.mp3',
            'https://zvukipro.com/uploads/files/2021-11/1637861222_4-1.mp3',
            'https://zvukipro.com/uploads/files/2021-11/1637861275_8-1.mp3',
            'https://zvukipro.com/uploads/files/2021-11/1637861465_gudok-poezd.mp3'
        ];

        let currentTrainInput = null;
        let currentStationInput = null;
        let currentPntsInput = null;
        let currentPntsValue = 0;

        function calculateScore(playerNumber) {
            const trainLengths = [1, 2, 3, 4, 6, 8];
            const pointsPerTrain = [1, 2, 4, 7, 15, 21];
            let trainPoints = 0;
            let usedCars = 0;

            trainLengths.forEach((length, index) => {
                const qty = Number(document.getElementById(`num${length}${playerNumber}`).value) || 0;
                trainPoints += qty * pointsPerTrain[index];
                usedCars += qty * length;
            });

            const stations = Number(document.getElementById(`stan${playerNumber}`).value) || 0;
            const stationPenalty = stations * 4;

            let pntsSum = 0;
            for (let i = 1; i <= 9; i++) {
                pntsSum += Number(document.getElementById(`pereg${i}${playerNumber}`).value) || 0;
            }

            const expressBonus = document.getElementById(`one${playerNumber}`).checked ? 10 : 0;

            const result = 12 + trainPoints - stationPenalty + pntsSum + expressBonus;
            const remainingCars = 45 - usedCars;

            document.getElementById(`result${playerNumber}`).innerHTML = result;
            document.getElementById(`kol${playerNumber}`).innerHTML = usedCars;
            document.getElementById(`kol${playerNumber}_ost`).innerHTML = remainingCars;

            const color = ['red', 'blue', 'green', 'yellow'][playerNumber - 1];
            document.getElementById(`${color}-score`).innerHTML = `(${result})`;

            const audio = new Audio();
            audio.src = soundFiles[playerNumber - 1];
            audio.autoplay = true;
        }

        const trainPopup = document.getElementById('train-popup');
        const stationPopup = document.getElementById('station-popup');
        const pntsPopup = document.getElementById('pnts-popup');
        trainPopup.style.display = 'none';
        stationPopup.style.display = 'none';
        pntsPopup.style.display = 'none';

        const trainInputs = document.querySelectorAll('.quantity-input');
        const stationInputs = document.querySelectorAll('.station-input');
        const pntsInputs = document.querySelectorAll('.pnts-input');

        trainInputs.forEach(input => {
            input.addEventListener('click', function(event) {
                currentTrainInput = input;
                trainPopup.style.display = 'block';
                stationPopup.style.display = 'none';
                pntsPopup.style.display = 'none';
            });
        });

        stationInputs.forEach(input => {
            input.addEventListener('click', function(event) {
                currentStationInput = input;
                stationPopup.style.display = 'block';
                trainPopup.style.display = 'none';
                pntsPopup.style.display = 'none';
            });
        });

        pntsInputs.forEach(input => {
            input.addEventListener('click', function(event) {
                currentPntsInput = input;
                currentPntsValue = Number(input.value) || 0;
                document.getElementById('pnts-current-value').textContent = currentPntsValue;
                pntsPopup.style.display = 'block';
                trainPopup.style.display = 'none';
                stationPopup.style.display = 'none';
            });
        });

        document.addEventListener('mousedown', function(event) {
            if (!trainPopup.contains(event.target) && 
                !stationPopup.contains(event.target) && 
                !pntsPopup.contains(event.target) && 
                !event.target.classList.contains('quantity-input') && 
                !event.target.classList.contains('station-input') && 
                !event.target.classList.contains('pnts-input')) {
                trainPopup.style.display = 'none';
                stationPopup.style.display = 'none';
                pntsPopup.style.display = 'none';
            }
        });

        function setTrainQuantity(value) {
            if (currentTrainInput) {
                currentTrainInput.value = value;
            }
            trainPopup.style.display = 'none';
        }

        function setStationQuantity(value) {
            if (currentStationInput) {
                currentStationInput.value = value;
            }
            stationPopup.style.display = 'none';
        }

        function changePnts(delta) {
            currentPntsValue += delta;
            document.getElementById('pnts-current-value').textContent = currentPntsValue;
        }

        function setPntsValue() {
            if (currentPntsInput) {
                currentPntsInput.value = currentPntsValue;
            }
            pntsPopup.style.display = 'none';
        }
    </script>
</body>

    
</html>
